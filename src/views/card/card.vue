<template>
  <div class=" relative flex flex-col  h-dvh ios-safe">
    <div class="py-10 px-14">
      <Title />
    </div>

    <div class=" relative  w-full flex-1 ">

      <div class=" zaodian relative  z-30 pb-[52rem]   -left-[1.25rem] w-[95%] h-full bg-cover bg-center  rounded-lg "
        :style="{ backgroundColor: layerColors[0] }"
        style="transform: rotate(-2deg);  ">
        <transition name="dissolve" mode="out-in">
          <div :key="`stage-${stage}`" class="dissolve-wrap">
            <div class=" mt-6  ml-2 absolute left-[16%] top-[6.1%] bg-cover bg-center p-4" style="transform: rotate(2deg)">
              <a_one_title v-if="stage === 0"  />
              <b_one_title v-else-if="stage === 1" />
              <c_one_title v-else />
            </div>

            <div class=" absolute left-[6rem] top-[14rem]" style="transform: rotate(2deg)" @click.stop="selectAnswer(1)">
              <a_one_q v-if="stage === 0" />
              <b_one_q v-else-if="stage === 1" />
              <c_one_q v-else />
            </div>

            <div class=" absolute left-[2.5rem] top-[18rem]" style="transform: rotate(2deg)" @click.stop="selectAnswer(2)">
              <a_tow_q v-if="stage === 0" />
              <b_tow_q v-else-if="stage === 1" />
              <c_tow_q v-else />
            </div>

            <div class=" absolute left-[6rem] top-[22rem]" style="transform: rotate(2deg)" @click.stop="selectAnswer(3)">
              <a_three_q v-if="stage === 0" />
              <b_three_q v-else-if="stage === 1" />
              <c_three_q v-else />
            </div>

            <div class="absolute left-[2.5rem] top-[26rem]" style=" transform: rotate(2deg)" @click.stop="selectAnswer(4)">
              <a_four_q v-if="stage === 0" />
              <b_four_q v-else-if="stage === 1" />
              <c_four_q v-else />
            </div>

            <div class=" absolute left-[6rem] top-[30rem]" style="transform: rotate(2deg)" @click.stop="selectAnswer(5)">
              <a_five_q v-if="stage === 0" />
              <b_five_q v-else-if="stage === 1" />
              <c_five_q v-else />
            </div>
          </div>
        </transition>
      </div>






      <div class=" z-20 absolute left-5   pb-[52rem]  -top-[1.25rem] w-[88%] h-full bg-cover bg-center  rounded-lg "
      :style="{ backgroundColor: layerColors[1] }">
        <div class=" absolute -right-[27px] top-[7.5rem]">
          <svg width="27" height="116" viewBox="0 0 27 116" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M0.214844 115.901V0.960938L17.3419 3.66448C22.5987 3.66448 26.858 11.2088 26.858 17.1856V99.673C26.858 105.65 22.5987 113.194 17.3419 113.194L0.214844 115.901Z"
              fill="#CCAE8F" />
            <path
              d="M8.3063 38.5139C8.3063 38.5139 7.39509 39.6119 6.77725 40.2921C6.61502 40.2507 6.53906 40.1022 6.53906 39.8985V27.6514L6.96706 27.5409V32.986H11.3783V29.2535L11.8028 29.143V32.986H15.5651V30.569C14.1685 29.8257 12.9424 28.7991 11.965 27.5547L12.0962 27.4062C13.7737 28.4421 16.4349 29.4572 19.0927 29.9302L18.3609 32.2125C18.1814 32.1711 18.0503 31.995 18.0503 31.6843C17.3396 31.4345 16.6475 31.1345 15.9793 30.7865V32.9722H19.5345L19.2998 35.2268C19.0789 35.1854 18.9339 35.0922 18.8752 34.7262H15.9793V36.8704L17.2288 37.8061C17.2288 37.8061 16.4039 38.8419 15.7998 39.5325C15.6411 39.491 15.5651 39.3426 15.5651 39.125V34.74H11.8132V36.4353L13.0937 37.3848C13.0937 37.3848 12.2239 38.4725 11.6233 39.1112C11.5475 39.0863 11.4828 39.0358 11.44 38.9685C11.3972 38.9011 11.379 38.821 11.3886 38.7418V34.74H6.98088V37.5229L8.3063 38.5139Z"
              fill="white" />
            <path
              d="M16.4762 48.4138C14.8021 47.8544 11.6439 46.8496 10.9225 46.6597C10.4721 46.5325 10.0091 46.4549 9.54183 46.4284C8.77902 46.456 8.27853 47.0154 7.00143 46.9739C6.84292 46.9845 6.68393 46.962 6.53458 46.9078C6.38523 46.8536 6.24878 46.769 6.13388 46.6592C6.01898 46.5495 5.92813 46.4171 5.86713 46.2703C5.80613 46.1236 5.77631 45.9658 5.77953 45.8069C5.77953 45.4616 6.00041 45.1819 6.52851 45.0576C8.0714 45.3166 9.37957 45.2613 9.63499 44.9368C9.78334 44.7253 9.86947 44.4765 9.88354 44.2186H10.1493V44.8539C10.1493 45.0576 10.1493 45.1267 10.4565 45.289C11.0018 45.6032 11.0019 45.6032 16.5728 48.21L16.4762 48.4138ZM16.0205 55.4333C16.0205 55.4333 15.1542 56.3966 14.5674 56.9663C14.4897 56.9411 14.4234 56.889 14.3804 56.8195C14.3374 56.7499 14.3205 56.6674 14.3327 56.5865V53.0612H11.5092V54.2041L12.3929 54.9499L11.1123 56.4829C10.9509 56.337 10.8428 56.1414 10.8051 55.927H6.40771C6.29036 55.927 5.92447 55.1536 5.92447 54.6115V54.3388H7.12914V50.2196H6.38012C6.21789 50.2196 5.84855 49.529 5.84855 48.873V48.6693H12.2134L11.5231 50.299V51.4384H14.3465V48.0063L14.771 47.8958V51.4384H17.2701C17.1527 50.3404 17.0664 49.1872 17.0353 48.1272L17.2562 48.0996C17.7655 50.4074 18.514 52.6558 19.4894 54.8083L17.843 56.3828C17.7118 56.2205 17.6981 55.9063 17.8741 55.4851C17.7257 54.7945 17.5807 53.9659 17.4599 53.0681H14.771V54.577L16.0205 55.4333ZM11.0812 50.2196H7.55368V54.3319H11.0812V50.2196ZM16.1241 44.1496C15.9481 47.8164 12.9486 46.7702 13.8909 45.3442C14.7012 45.1085 15.4324 44.6575 16.0067 44.0391L16.1241 44.1496ZM19.3445 45.1681C19.1684 48.9662 16.1103 47.9925 16.9905 46.4836C17.8327 46.1806 18.5968 45.6934 19.2271 45.0576L19.3445 45.1681Z"
              fill="white" />
            <path
              d="M17.8012 71.7012C17.8012 71.7012 16.9313 72.737 16.3307 73.3689C16.253 73.3437 16.1867 73.2916 16.1438 73.2221C16.1008 73.1525 16.0839 73.0699 16.0961 72.9891V66.4288C15.2262 66.3735 14.3909 66.3045 13.5798 66.1974V69.4293L14.4772 70.2856L13.1242 71.7357C12.9656 71.5818 12.8717 71.3731 12.8619 71.1522C9.15826 70.9623 7.12867 70.6101 6.45215 69.8367C6.00318 69.309 5.7811 68.6251 5.83434 67.9342C6.34863 67.9342 6.77663 67.8824 6.99754 67.6511C7.33541 67.2362 7.55804 66.7396 7.64299 66.2112H7.81903C7.77416 66.85 7.70165 67.8686 7.70165 68.1655C7.69042 68.2566 7.69748 68.349 7.72238 68.4374C7.74727 68.5257 7.7895 68.6082 7.84663 68.68C8.24702 69.1012 10.1696 69.3706 13.1553 69.5363V66.0835C9.96594 65.5276 7.28748 64.2121 5.74805 60.8456L5.89299 60.7489C8.45066 63.8565 12.068 64.547 16.0961 64.5919V60.818L16.5206 60.7109V70.7828L17.8012 71.7012ZM19.6374 65.5621C19.1232 69.7055 15.7716 68.3865 16.9313 66.8259C17.9016 66.5926 18.8007 66.1269 19.5512 65.4689L19.6374 65.5621Z"
              fill="white" />
            <path
              d="M7.77452 89.4845C6.89435 89.961 6.39386 90.0266 6.17295 89.7987C5.48262 89.16 6.12808 88.0447 6.73212 87.4336C8.89284 85.2341 12.096 84.4607 15.8445 84.219V77.4412L16.2725 77.3203V84.1914C17.308 84.1361 18.4021 84.1085 19.5204 84.1085L19.2857 86.2527C19.0924 86.2251 18.9164 86.1042 18.8577 85.7658C17.9914 85.7658 17.1319 85.7659 16.2725 85.7935V87.3403L17.094 87.9791C17.1107 87.8576 17.1506 87.7404 17.2113 87.6338C17.8925 87.3368 18.4961 86.8866 18.9751 86.3183L19.0924 86.4115C19.2408 88.9528 17.7566 89.1738 17.2423 88.5592C16.9628 88.9044 16.4623 89.5087 16.0791 89.9403C16.0014 89.9107 15.936 89.8557 15.8934 89.7843C15.8508 89.7129 15.8336 89.6291 15.8445 89.5467V85.8073C12.7587 85.9834 9.97665 86.6083 8.45103 88.3865C8.24738 88.5764 8.24738 88.6835 8.4959 88.8078C9.082 89.1223 9.6859 89.4025 10.3046 89.6468L10.2735 89.7987L7.77452 89.4845ZM8.83415 81.7744C9.02399 82.6825 9.23111 83.6596 9.45201 84.6506L9.2587 84.692C8.56837 83.4283 7.6882 81.5845 6.49739 78.8016C6.41212 78.7756 6.33359 78.7313 6.26738 78.6716C6.20116 78.6119 6.14889 78.5384 6.11426 78.4563L7.98161 77.4204C8.07135 78.0074 8.26119 78.9846 8.4959 80.1654H12.876V77.9211L13.2902 77.8141V81.9574L14.4776 82.8137C14.4776 82.8137 13.6699 83.7632 13.0969 84.3467C13.0218 84.3219 12.9575 84.272 12.9147 84.2054C12.872 84.1387 12.8535 84.0594 12.8622 83.9808V81.7813L8.83415 81.7744Z"
              fill="white" />
          </svg>

        </div>

        <div class=" absolute -right-[27px] top-[14.5rem]">
          <svg width="27" height="116" viewBox="0 0 27 116" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M0.214844 115.65V0.726562L17.3419 3.43011C22.5987 3.43011 26.858 10.9745 26.858 16.9513V99.4248C26.858 105.402 22.5987 112.946 17.3419 112.946L0.214844 115.65Z"
              fill="#746C61" />
            <path
              d="M13.0515 30.8257C12.199 34.3303 9.4653 33.1218 10.525 31.8028C11.2904 31.6151 12.0131 31.2836 12.6546 30.8257H6.37953C6.27598 30.8257 5.86523 30.3388 5.86523 29.5654V29.2926H11.4948C10.9119 28.6735 10.3948 27.9954 9.95197 27.2693L10.0831 27.1484C11.7762 28.7692 13.7955 30.0099 16.0062 30.7877V27.5282L16.4342 27.4039V30.7324L17.3281 31.6026L15.8301 33.0113C15.6962 32.838 15.6288 32.6224 15.6403 32.4036C14.75 31.9646 13.9069 31.4359 13.124 30.8257H13.0515ZM8.37804 38.5945C8.37804 38.5945 7.4668 39.5854 6.86276 40.1551C6.70054 40.1137 6.62803 39.979 6.62803 39.7753V31.7924L7.05603 31.682V35.0622H13.9352V32.6177L14.3459 32.5106V35.0622H19.4889L19.2714 37.2202C19.0505 37.1822 18.9021 37.0856 18.8434 36.7196H14.3563V37.5897L15.5919 38.4149C15.5919 38.4149 14.7532 39.3403 14.1802 39.8824C14.018 39.8409 13.9455 39.7063 13.9455 39.5026V36.7196H7.0664V37.7554L8.37804 38.5945ZM19.6097 28.792C18.8434 32.4278 16.0372 30.9223 17.228 29.5654C18.0508 29.4306 18.8363 29.1248 19.5337 28.6677L19.6097 28.792Z"
              fill="white" />
            <path
              d="M12.7724 53.9339C12.6102 53.8683 12.5239 53.7164 12.5515 53.3918C11.4094 52.8766 10.3598 52.1766 9.44506 51.3202C8.46808 53.0033 7.81589 54.855 7.52247 56.779L7.34302 56.7514C7.19805 56.0194 6.65268 55.5429 5.81738 55.315C6.33785 53.4773 7.28385 51.7881 8.5787 50.3844C7.25672 48.7823 6.28681 46.6934 5.81738 43.9622L6.00724 43.8828C6.65118 46.0356 7.85966 47.9765 9.50717 49.504C10.6228 48.6368 11.894 47.991 13.2522 47.6015L13.4006 47.7776C12.1742 48.2873 11.0971 49.0999 10.27 50.1393C11.305 50.937 12.4738 51.5438 13.7217 51.9313L12.7724 53.9339ZM11.7887 44.4042C13.0357 45.7566 14.5886 46.7903 16.3173 47.4185L15.2266 49.4004C15.0816 49.3451 14.9781 49.2105 15.0229 48.8859C13.4984 47.7741 12.3207 46.2523 11.6265 44.4974L11.7887 44.4042ZM16.0377 51.5998C15.0954 57.0587 11.1847 56.2439 12.1995 54.4795C13.5214 53.9616 15.0229 52.6322 15.9203 51.4928L16.0377 51.5998ZM16.4174 44.1728L16.8316 44.0658V54.0444L18.2571 54.9525C18.2571 54.9525 17.2872 55.9883 16.6521 56.5822C16.5743 56.557 16.5081 56.5049 16.4651 56.4354C16.4221 56.3658 16.4052 56.2833 16.4174 56.2024V44.1728ZM19.6101 48.5061C19.2995 52.5217 16.0066 51.3547 17.0663 49.7802C17.9914 49.5436 18.8379 49.0672 19.5204 48.3991L19.6101 48.5061Z"
              fill="white" />
            <path
              d="M11.934 67.5344C9.67316 68.5703 8.21658 70.7525 7.71609 73.2074H7.54005C7.35021 72.5548 6.74617 72.0645 5.84874 71.8746C6.88423 69.43 8.76196 68.0765 11.8339 67.3135C9.52477 66.9337 7.09826 65.5076 5.83496 60.4424L5.99718 60.3906C7.723 64.0679 9.79397 65.2763 11.934 65.6043V60.6288L12.362 60.5356V65.625C12.7184 65.6641 13.0769 65.6826 13.4354 65.6803H15.61V61.499L16.0207 61.3884V67.569C17.1834 68.0101 18.3776 68.3633 19.5932 68.6255L18.8752 70.8526C18.6957 70.7973 18.5784 70.6351 18.5957 70.3381C17.6603 69.6187 16.7979 68.8092 16.0207 67.9212V69.6855L17.2564 70.6074C17.2564 70.6074 16.435 71.6433 15.8447 72.2786C15.6825 72.251 15.61 72.0887 15.61 71.8988V67.4101H13.4631C13.0954 67.4115 12.7279 67.3942 12.362 67.3583V70.4106L13.6426 71.3498C13.6426 71.3498 12.7728 72.434 12.1722 73.0762C12.0099 73.0348 11.934 72.8863 11.934 72.6826V67.5344ZM19.4896 63.1218C18.6095 67.2651 15.3477 65.9047 16.5523 64.3579C17.5994 64.1521 18.5791 63.6894 19.4033 63.0113L19.4896 63.1218Z"
              fill="white" />
            <path
              d="M13.8322 85.3301C13.0832 90.2607 9.45203 89.5011 10.3805 87.8576C10.9592 87.6282 11.4993 87.3115 11.9821 86.9184C11.8233 86.145 11.6369 85.2369 11.4402 84.1562H7.61921C6.51469 84.1562 5.83819 83.8972 5.70703 82.119C6.0843 82.1344 6.45902 82.0511 6.79426 81.8773C6.9471 81.7416 7.07134 81.5767 7.15965 81.3923C7.24796 81.2079 7.29857 81.0077 7.30856 80.8035H7.50187C7.50187 80.8035 7.41212 81.9705 7.41212 82.2433C7.41212 82.447 7.50185 82.4988 7.66063 82.4988H11.1606C10.9846 81.463 10.7947 80.327 10.6153 79.0909C10.4671 79.0244 10.3456 78.9102 10.2701 78.7664L12.1202 77.9653C12.1426 78.1911 12.1866 78.4142 12.2513 78.6317C12.8667 80.366 13.7131 82.0094 14.7676 83.5174C14.488 82.4609 14.1635 81.1004 13.8564 79.6226C13.743 79.5597 13.6506 79.4648 13.5906 79.3499L15.4441 78.5627C15.4588 78.7248 15.4924 78.8848 15.5442 79.0391C15.8411 79.961 16.7212 81.1419 17.4426 81.9153C17.3529 80.4237 17.2942 78.8768 17.2942 77.4508L17.5289 77.4232C17.9707 80.7206 18.9095 84.9848 19.6758 87.1705L17.9845 88.7173C17.8395 88.555 17.8223 88.2305 18.0294 87.7816C17.8533 86.5593 17.6842 85.0194 17.5461 83.3828L16.9697 84.3323C16.8247 84.2667 16.735 84.0768 16.8109 83.7764C16.1553 82.5612 15.6367 81.277 15.2646 79.9472C15.2646 81.0349 15.2957 82.6646 15.3544 84.3737C15.7848 84.9935 16.2725 85.5715 16.8109 86.1001L15.4303 87.7575C15.3453 87.6773 15.2882 87.5722 15.267 87.4573C15.2459 87.3424 15.262 87.2238 15.3129 87.1187C14.312 85.5994 12.8968 82.3952 12.0339 79.6917C12.0787 81.3767 12.1823 83.9283 12.3134 86.6456C12.8349 86.2133 13.3083 85.726 13.7252 85.192L13.8322 85.3301ZM9.34503 81.8773C9.19661 81.7841 9.12414 81.6736 9.18282 81.349C7.91103 80.1797 6.90773 78.7484 6.24201 77.1539L6.40423 77.0469C7.57144 78.2852 8.95687 79.2977 10.491 80.0336L9.34503 81.8773ZM10.346 84.9849C9.33123 90.1986 5.51372 89.3008 6.59754 87.5917C7.87465 87.1428 9.33124 85.9205 10.2252 84.8743L10.346 84.9849Z"
              fill="white" />
          </svg>


        </div>

        <div class=" absolute -right-[27px] top-[21.5rem]">
          <svg width="27" height="115" viewBox="0 0 27 115" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0.101562 114.963V0.078125L17.2286 2.78075C22.4855 2.78075 26.7448 10.3226 26.7414 16.2974V98.7433C26.7414 104.718 22.4855 112.26 17.2286 112.26L0.101562 114.963Z" fill="#937091"/>
<path d="M11.5402 39.1083C11.4091 39.0255 11.3193 38.9047 11.3953 38.6044C10.8355 37.6683 10.363 36.6827 9.98361 35.6601C9.02755 36.7251 8.39941 38.0435 8.17487 39.4569L7.96774 39.4293C7.78858 39.0776 7.52415 38.7764 7.19854 38.5533C6.87293 38.3302 6.49656 38.1923 6.10389 38.1522C7.20496 35.7361 9.4106 34.2726 13.0417 33.565C12.2886 33.0286 11.6277 32.3735 11.0847 31.6252H7.80898C8.0575 32.4674 8.35096 33.4856 8.66161 34.5038L8.49931 34.5556C7.92634 33.7686 6.89775 32.3431 5.82429 30.6346C5.70622 30.5507 5.60152 30.4494 5.51367 30.3343L7.23949 29.2988C7.60537 29.9201 7.76753 30.0167 8.0333 30.0167H10.0595C9.48129 28.9422 9.01849 27.8095 8.6788 26.6376L8.87211 26.5547C9.85584 28.4643 11.301 30.0981 13.0763 31.3076V26.962L13.5008 26.855V32.2016H15.2266V28.3047L15.6407 28.1977V32.2016H17.27V27.6558L17.6979 27.5315V32.2016H19.5343L19.3443 34.3451C19.1372 34.3175 18.9992 34.1966 18.9336 33.8446H17.6979V36.4506L18.9026 37.279C18.9026 37.279 18.0811 38.2143 17.5219 38.7701C17.4462 38.7459 17.3811 38.6962 17.3377 38.6296C17.2943 38.5629 17.2753 38.4833 17.2838 38.4042V33.8446H15.6546V35.9881L16.8454 36.7888C16.8454 36.7888 16.0343 37.7104 15.4648 38.2558C15.3864 38.2312 15.3193 38.1794 15.2757 38.1098C15.232 38.0403 15.2147 37.9574 15.2266 37.8761V33.8446H13.5008V36.9131L14.7365 37.7657C14.7365 37.7657 13.8977 38.7183 13.3109 39.2878C13.2331 39.2626 13.167 39.2105 13.124 39.141C13.081 39.0715 13.0641 38.989 13.0763 38.9081V33.8308C12.045 34.1321 11.0918 34.6552 10.2838 35.3633C11.0595 36.0932 11.9059 36.7442 12.8105 37.3066L11.5402 39.1083Z" fill="white"/>
<path d="M9.09959 46.6561C7.90878 47.7433 7.60147 49.155 7.60147 51.8956C7.60147 53.335 7.60157 54.5431 7.70512 56.01H7.529C7.36677 55.3991 6.77663 55.0435 6.0725 54.9745V51.3883C6.0725 48.6891 6.80774 47.5086 8.6164 46.4075C8.73375 46.3419 8.80618 46.2729 8.81999 46.2039L8.77853 46.0417C8.73033 45.9901 8.67592 45.9449 8.6164 45.907C8.12972 45.6206 6.98372 44.8336 6.14497 44.3469C6.07765 44.3603 6.00771 44.3518 5.94559 44.3226C5.88347 44.2934 5.83243 44.2451 5.7998 44.1847L7.59456 43.125C7.93972 43.6945 8.44715 44.4677 8.84409 45.0786H13.7248V43.3528L14.1355 43.27V44.8577L15.2677 45.6447L13.8111 47.3153C13.6236 47.1316 13.5085 46.8865 13.4866 46.625L9.09959 46.6561ZM15.7025 47.2118V50.4011C16.8036 50.4701 18.0083 50.4563 19.3751 50.4701L19.1852 52.655C19.0671 52.6392 18.9588 52.5812 18.8801 52.4917C18.8015 52.4023 18.7579 52.2874 18.7573 52.1683C17.6424 52.1407 16.6414 52.1269 15.7025 52.0578V53.7147L16.9659 54.5431C16.9659 54.5431 16.1133 55.4923 15.5231 56.0618C15.4453 56.0365 15.3791 55.9845 15.3361 55.915C15.2932 55.8455 15.2761 55.7629 15.2883 55.6821V52.0578C14.7091 52.0133 14.1329 51.9361 13.5625 51.8266C11.4915 57.0524 7.8156 56.0479 9.03403 54.298C10.3284 53.7975 11.8713 52.724 13.0759 51.7196C11.0774 51.1915 9.62424 50.0214 8.66814 47.3222L8.87173 47.1876C10.4319 49.5485 12.4303 50.2113 15.2952 50.4045V47.336L15.7025 47.2118ZM19.2128 44.0225C18.0531 48.2162 14.7464 46.9287 15.9786 45.3824C17.1103 45.0805 18.1773 44.574 19.1265 43.8878L19.2128 44.0225Z" fill="white"/>
<path d="M17.6879 70.8035C17.6879 70.8035 16.8215 71.8389 16.2209 72.474C16.1419 72.4494 16.0744 72.3971 16.0306 72.3268C15.9869 72.2564 15.9699 72.1727 15.9828 72.0909V65.5328C15.1164 65.4776 14.2776 65.412 13.4699 65.3015V68.5564L14.3674 69.4124L13.0143 70.8656C12.8559 70.7112 12.761 70.5031 12.7486 70.2823C9.04494 70.0924 7.01881 69.7369 6.34228 68.9637C5.89318 68.4377 5.67098 67.755 5.72443 67.0653C6.23872 67.0653 6.6634 67.0101 6.8843 66.7788C7.22483 66.3653 7.4488 65.8685 7.53317 65.3395H7.70912C7.66425 65.9781 7.59182 66.9963 7.59182 67.2931C7.58012 67.3847 7.58697 67.4778 7.61188 67.5667C7.63678 67.6556 7.67919 67.7387 7.73676 67.8109C8.1337 68.232 10.0597 68.5012 13.0453 68.6669V65.2325C9.85258 64.6733 7.19491 63.3582 5.63477 59.9929L5.78308 59.8963C8.34074 63.0028 11.9547 63.6931 15.9828 63.738V59.9273L16.4107 59.8203V69.8922L17.6879 70.8035ZM19.5276 64.6699C19.0133 68.8119 15.6618 67.4899 16.8216 65.9297C17.7911 65.6973 18.6891 65.2317 19.4378 64.5732L19.5276 64.6699Z" fill="white"/>
<path d="M7.67787 88.5698C6.79425 89.0427 6.29717 89.1117 6.07626 88.8805C5.38593 88.2419 6.03143 87.1305 6.63547 86.5196C8.7962 84.3209 11.9993 83.5477 15.7478 83.3026V76.5305L16.1759 76.4062V83.275C17.2113 83.2198 18.3054 83.1922 19.4237 83.1922L19.1891 85.3391C18.9958 85.3115 18.8197 85.1872 18.761 84.849C17.8947 84.849 17.0353 84.849 16.1759 84.8766V86.4229L16.9973 87.0615C17.0162 86.947 17.0559 86.837 17.1146 86.737C17.7957 86.4382 18.3992 85.9872 18.8785 85.4185L18.9958 85.5151C19.1442 88.0521 17.6601 88.2764 17.1458 87.6586C16.8662 88.0038 16.3657 88.6078 15.9825 89.0392C15.9041 89.0107 15.8379 88.956 15.7951 88.8843C15.7524 88.8126 15.7356 88.7283 15.7478 88.6458V84.8869C12.662 85.0629 9.89726 85.6877 8.35438 87.4653C8.14728 87.6552 8.14724 87.7656 8.39921 87.8864C8.98467 88.2008 9.58735 88.4819 10.2044 88.7286L10.1769 88.877L7.67787 88.5698ZM8.73747 80.8589C8.92731 81.7701 9.1345 82.7469 9.35195 83.7375L9.16201 83.7755C8.47168 82.5156 7.58806 80.669 6.4007 77.887C6.31564 77.8607 6.2373 77.8162 6.17115 77.7566C6.10499 77.697 6.05265 77.6237 6.01761 77.5419L7.885 76.5064C7.9713 77.0897 8.1645 78.0665 8.39921 79.2469H12.7793V76.9792L13.1902 76.8722V81.0142L14.3809 81.8702C14.3809 81.8702 13.5732 82.8194 13.0003 83.4027C12.9251 83.3779 12.8608 83.328 12.8181 83.2614C12.7754 83.1948 12.7569 83.1155 12.7657 83.0368V80.8381L8.73747 80.8589Z" fill="white"/>
</svg>



        </div>


      </div>

      <div class=" z-10  absolute   pb-[52rem]   -bottom-2 left-[0.4rem]  w-[94%] h-full bg-cover bg-center  rounded-lg "
      :style="{ backgroundColor: layerColors[2] }">

      </div>

    </div>

  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { useRouter } from 'vue-router'
import Title from './title.vue'
import a_one_title from './one/title.vue'
import a_one_q from './one/one.vue'
import a_tow_q from './one/two.vue'
import a_three_q from './one/three.vue'
import a_four_q from './one/four.vue'
import a_five_q from './one/five.vue'


import b_one_title from './tow/title.vue'
import b_one_q from './tow/one.vue'
import b_tow_q from './tow/two.vue'
import b_three_q from './tow/three.vue'
import b_four_q from './tow/four.vue'
import b_five_q from './tow/five.vue'


import c_one_title from './three/title.vue'
import c_one_q from './three/one.vue'
import c_tow_q from './three/two.vue'
import c_three_q from './three/three.vue'
import c_four_q from './three/four.vue'
import c_five_q from './three/five.vue'

const aTextureNames = ['A1.png', 'A2.png', 'A3.png', 'A4.png', 'A5.png', 'A6.png']
const bTextureNames = ['B2.png', 'B1.png', 'B3.png', 'B4.png', 'B5.png', 'B6.png']

const randomIndex = Math.floor(Math.random() * Math.min(aTextureNames.length, bTextureNames.length))
const selectedATexture = ref(aTextureNames[randomIndex])
const selectedBTexture = ref(bTextureNames[randomIndex])


const colors = ref(['#ead1bc', '#a48260', '#b884af'])
// 三层颜色栈，随阶段循环（出栈入栈）
const layerColors = ref<string[]>([...colors.value])

// 0: A, 1: B, 2: C
const stage = ref(0)
const router = useRouter()

function handleClick() {
  if (stage.value < 2) {
    stage.value += 1
    // 颜色栈旋转：仅在阶段推进时旋转
    const first = layerColors.value.shift()
    if (first) layerColors.value.push(first)
    return
  }
  // 最后一阶段直接跳转，不再变更颜色
  router.push({ path: `/wait/${selectedATexture.value}/${selectedBTexture.value}` })
}



// 生成噪点图片的工具函数
function generateNoise(opacity: number = 0.06, size: number = 100): string {
  const canvas = document.createElement('canvas');
  canvas.width = size;
  canvas.height = size;
  const ctx = canvas.getContext('2d');
  if (!ctx) return '';

  const imageData = ctx.createImageData(size, size);
  const buffer = imageData.data;

  for (let i = 0; i < buffer.length; i += 4) {
    const value = Math.random() * 255;
    buffer[i] = value;     // R
    buffer[i + 1] = value; // G
    buffer[i + 2] = value; // B
    buffer[i + 3] = Math.floor(opacity * 255); // Alpha
  }

  ctx.putImageData(imageData, 0, 0);
  return canvas.toDataURL();
}

// 在 onMounted 生命周期钩子中设置噪点背景，避免 SSR/TS 报错
import { onMounted } from 'vue';

onMounted(() => {
  const targetDiv = document.querySelector('div.zaodian') as HTMLElement | null;
  if (targetDiv) {
    const noiseURL = generateNoise(0.08, 1000); // 不透明度 & 噪点尺寸
    targetDiv.style.backgroundImage = `url(${noiseURL})`;
    targetDiv.style.backgroundBlendMode = 'multiply';
    targetDiv.style.backgroundRepeat = 'repeat';
  }
});

// 记录答案与阶段推进
type AnswerRecord = {
  group: 'A' | 'B' | 'C';
  index: number; // 1-5
  timestamp: number;
};

const ANSWERS_STORAGE_KEY = 'card_answers';
const answers = ref<AnswerRecord[]>([]);

function persistAnswers() {
  try {
    localStorage.setItem(ANSWERS_STORAGE_KEY, JSON.stringify(answers.value));
  } catch (_) {}
}

function loadAnswers() {
  try {
    const raw = localStorage.getItem(ANSWERS_STORAGE_KEY);
    if (raw) answers.value = JSON.parse(raw);
  } catch (_) {}
}

loadAnswers();

function rotateLayerColors() {
  const first = layerColors.value.shift();
  if (first) layerColors.value.push(first);
}

function selectAnswer(idx: number) {
  const group = stage.value === 0 ? 'A' : stage.value === 1 ? 'B' : 'C';
  answers.value.push({ group, index: idx, timestamp: Date.now() });
  console.log(answers.value)
  persistAnswers();

  if (stage.value < 2) {
    stage.value += 1;
    rotateLayerColors();
  } else {
    router.push({ path: `/wait/${selectedATexture.value}/${selectedBTexture.value}` });
  }
}

</script>

<style scoped>
/* iOS bottom bar safe-area padding for full-bleed pages */
.ios-safe {
  padding-bottom: calc(constant(safe-area-inset-bottom) + 12px);
  padding-bottom: calc(env(safe-area-inset-bottom) + 12px);
}

/* 颗粒消散 + 淡入淡出 */
.dissolve-enter-active,
.dissolve-leave-active {
  transition: opacity 360ms ease;
  /* 同步粒子遮罩动画时长 */
}
.dissolve-enter-from,
.dissolve-leave-to {
  opacity: 0;
}

/* 粒子遮罩实现：使用子层遮罩在切换时制造"砂化"效果 */
.dissolve-wrap {
  position: relative;
}
.dissolve-wrap::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(circle at 20% 30%, rgba(0,0,0,0.12), transparent 40%),
              radial-gradient(circle at 70% 40%, rgba(0,0,0,0.10), transparent 42%),
              radial-gradient(circle at 40% 70%, rgba(0,0,0,0.08), transparent 45%),
              radial-gradient(circle at 85% 75%, rgba(0,0,0,0.06), transparent 46%),
              radial-gradient(circle at 10% 80%, rgba(0,0,0,0.06), transparent 44%);
  opacity: 0;
  mask-image: radial-gradient(120px 120px at 30% 30%, #000 20%, transparent 60%),
              radial-gradient(100px 100px at 70% 20%, #000 18%, transparent 55%),
              radial-gradient(140px 140px at 50% 70%, #000 22%, transparent 60%),
              radial-gradient(120px 120px at 80% 80%, #000 18%, transparent 58%);
  -webkit-mask-image: radial-gradient(120px 120px at 30% 30%, #000 20%, transparent 60%),
                       radial-gradient(100px 100px at 70% 20%, #000 18%, transparent 55%),
                       radial-gradient(140px 140px at 50% 70%, #000 22%, transparent 60%),
                       radial-gradient(120px 120px at 80% 80%, #000 18%, transparent 58%);
  mix-blend-mode: multiply;
}
.dissolve-leave-active .dissolve-wrap::before,
.dissolve-enter-active .dissolve-wrap::before {
  animation: particle-dissolve 360ms ease forwards;
}

@keyframes particle-dissolve {
  0% { opacity: 0; filter: blur(0px); }
  50% { opacity: 0.35; filter: blur(0.8px); }
  100% { opacity: 0; filter: blur(0px); }
}
</style>
